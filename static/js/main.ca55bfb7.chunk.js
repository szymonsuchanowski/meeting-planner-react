(this["webpackJsonp29-task-react-composition"]=this["webpackJsonp29-task-react-composition"]||[]).push([[0],{19:function(e,t,n){},20:function(e,t,n){},22:function(e,t,n){},23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){},26:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),s=n(9),i=n.n(s),c=(n(18),n(19),n(2)),o=n(3),u=n(6),l=n(5),d=function(){function e(){Object(c.a)(this,e),this.url="https://fake-server-trip-booking.herokuapp.com/meetings"}return Object(o.a)(e,[{key:"loadData",value:function(){return this._fetch("")}},{key:"loadFilteredData",value:function(e,t){return this._fetch("?".concat(e,"_like=").concat(t))}},{key:"addData",value:function(e){var t={method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}};return this._fetch("",t)}},{key:"removeData",value:function(e){return this._fetch("/".concat(e),{method:"DELETE"})}},{key:"_fetch",value:function(e,t){var n=this.url+e;return fetch(n,t).then((function(e){return e.ok?e.json():Promise.reject(new Error("No connection with json-server!"))}))}}]),e}(),h=n(11),m=n(4),f=n(7),j=function(){function e(){Object(c.a)(this,e),this.name={regExp:/^[a-zA-Z]{3,}(?:(-| )[a-zA-Z]+){0,2}$/,err:"required (min. 3 characters)"},this.lastName={regExp:/^[a-zA-Z]{3,}(?:(-| )[a-zA-Z]+){0,2}$/,err:"required (min. 3 characters)"},this.email={regExp:/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$/,err:"required (valid e-mail address)"},this.date={regExp:/^20\d{2}[-/.](0[1-9]|1[0-2])[-/.](0[1-9]|[12]\d|3[01])$/,err:"required - today/future (dd.mm.yyyy)"},this.time={regExp:/^([01]?[0-9]|2[0-3]):[0-5][0-9]$/,err:"required (hh:mm)"}}return Object(o.a)(e,[{key:"checkDataErrors",value:function(e,t){var n=this.isMatchRegex(e,t.trim()),a="date"!==e||this.isFutureDate(t);return n&&a?null:this.createErrObject(e)}},{key:"isMatchRegex",value:function(e,t){return this[e].regExp.test(t)}},{key:"isFutureDate",value:function(e){var t=this.getCurrentDate();return new Date(e)>=new Date(t)}},{key:"getCurrentDate",value:function(){var e=6e4*(new Date).getTimezoneOffset();return new Date(Date.now()-e).toISOString().slice(0,10)}},{key:"createErrObject",value:function(e){return Object(m.a)({},e,this[e].err)}}]),e}(),p=(n(20),function(e){return 0===e.length}),g=function(e){return"date"===e?function(){var e=6e4*(new Date).getTimezoneOffset();return new Date(Date.now()-e).toISOString().slice(0,10)}():null},v=function(e){return 0===Object.keys(e).length},b=function(e){return Object.assign.apply(Object,[{}].concat(Object(h.a)(e)))},_=function(e){var t=O(e);return t.push({errors:{}}),b(t)},O=function(e){return e.map((function(e){var t=e.name,n=e.filter,a=Object(m.a)({},t,{value:"",isValid:!0});return n?y(a,t):a}))},y=function(e,t){return Object(m.a)({},t,Object(f.a)(Object(f.a)({},e[t]),{},{showSuggestions:!1,dataSuggestions:[]}))},x=function(e){return e.split("-").reverse().join(".")},k=n(0),N=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state=_(e.props.fields),e.api=new d,e.submitHandler=function(t){t.preventDefault();var n=e.findErrors();return v(n)?e.addNewMeeting():e.showErrors(n)},e.handleFocus=function(t,n){return n?e.updateInputState(t,{showSuggestions:!0}):null},e.handleBlur=function(t,n){return n&&setTimeout((function(){e.updateInputState(t,{showSuggestions:!1})}),200),null},e.inputChange=function(t){t.preventDefault();var n=t.target,a=n.name,r={value:n.value};e.setState((function(e){return Object(m.a)({},a,Object(f.a)(Object(f.a)({},e[a]),r))}),(function(){return e.findSuggestions(a)}))},e.completeField=function(t,n){var a={value:t.target.innerText,dataSuggestions:[]};e.updateInputState(n,a)},e}return Object(o.a)(n,[{key:"render",value:function(){return Object(k.jsxs)("section",{className:"calendar__section calendar__section--form",children:[Object(k.jsx)("header",{className:"calendar__subheader",children:Object(k.jsx)("h2",{className:"calendar__subtitle",children:"new meeting"})}),Object(k.jsx)("div",{className:"calendar__container",children:Object(k.jsxs)("form",{className:"calendar__form form",onSubmit:this.submitHandler,noValidate:!0,children:[this.renderFormInputs(),Object(k.jsx)("div",{className:"form__field",children:Object(k.jsx)("input",{className:"form__submit",value:"Add",type:"submit"})})]})})]})}},{key:"renderFormInputs",value:function(){var e=this;return this.props.fields.map((function(t){var n=t.name,a=t.label,r=t.type,s=t.filter;return Object(k.jsxs)("div",{className:"form__field",onFocus:function(){return e.handleFocus(n,s)},onBlur:function(){return e.handleBlur(n,s)},children:[Object(k.jsxs)("label",{className:"form__label",htmlFor:n,children:[a,Object(k.jsx)("input",{className:e.setInputClassName(n),id:n,name:n,type:r,value:e.state[n].value,onChange:e.inputChange,min:g(r),autoComplete:"off"}),Object(k.jsx)("span",{className:e.setBorderClassName(n)})]}),e.renderSuggestions(n),Object(k.jsx)("div",{className:"form__placeholder",children:e.renderFormErrMsg(n)})]},n)}))}},{key:"renderSuggestions",value:function(e){return this.isSuggestion(e)?this.renderSuggestionsList(e):null}},{key:"renderFormErrMsg",value:function(e){return!v(this.state.errors)&&this.state.errors[e]?this.showErrMsg(e):null}},{key:"findErrors",value:function(){var e=[];return this.createErrors(e),b(e)}},{key:"createErrors",value:function(e){var t=this,n=new j;this.getInputsNames().forEach((function(a){var r=n.checkDataErrors(a,t.state[a].value);return r?t.setInputInvalid(e,r,a):t.setInputValid(a)}))}},{key:"setInputInvalid",value:function(e,t,n){e.push(t);this.updateInputState(n,{isValid:!1})}},{key:"setInputValid",value:function(e){if(!this.state[e].isValid){this.updateInputState(e,{isValid:!0})}}},{key:"addNewMeeting",value:function(){var e=this.getInputValues(),t=b(e);this.props.addMeeting(t);var n=_(this.props.fields);this.setState(n)}},{key:"showErrors",value:function(e){this.setState({errors:e})}},{key:"findSuggestions",value:function(e){return this.state[e].showSuggestions&&this.state[e].value.length>1?this.filterData(e):null}},{key:"filterData",value:function(e){var t=this;this.api.loadFilteredData(e,this.state[e].value).then((function(n){return t.updateSuggestionsState(n,e)}))}},{key:"updateSuggestionsState",value:function(e,t){var n={dataSuggestions:e};this.updateInputState(t,n)}},{key:"isSuggestion",value:function(e){var t=this.state[e],n=t.showSuggestions,a=t.dataSuggestions,r=t.value;return n&&!p(a)&&r.length>1}},{key:"renderSuggestionsList",value:function(e){var t=this.getSuggestionContentList(e),n=this.renderSuggestionItem(t,e);return Object(k.jsxs)("ul",{className:"form__prompts",children:[Object(k.jsx)("li",{className:"form__suggestion form__suggestion--desc",children:"API suggestions"}),n]})}},{key:"getSuggestionContentList",value:function(e){var t=this.state[e].dataSuggestions.map((function(t){return t[e]}));return Object(h.a)(new Set(t))}},{key:"renderSuggestionItem",value:function(e,t){var n=this;return e.map((function(e,a){return Object(k.jsx)("li",{className:"form__suggestion",onClick:function(e){return n.completeField(e,t)},children:e},a)}))}},{key:"showErrMsg",value:function(e){var t=this.state.errors[e];return Object(k.jsx)("p",{className:"form__err",children:t})}},{key:"updateInputState",value:function(e,t){this.setState((function(n){return Object(m.a)({},e,Object(f.a)(Object(f.a)({},n[e]),t))}))}},{key:"getInputValues",value:function(){var e=this;return this.getInputsNames().map((function(t){return Object(m.a)({},t,e.state[t].value.trim())}))}},{key:"getInputsNames",value:function(){return this.props.fields.map((function(e){return e.name}))}},{key:"setInputClassName",value:function(e){return this.state[e].isValid?"form__input":"form__input form__input--invalid"}},{key:"setBorderClassName",value:function(e){return this.state[e].isValid?"form__border":"form__border form__border--invalid"}}]),n}(r.a.Component),S=n(13),M=(n(22),n(23),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).handleClick=function(t){var n=e.props.closeModal;return t.target.classList.contains("modal")?n():null},e}return Object(o.a)(n,[{key:"render",value:function(){var e=this,t=this.props,n=t.name,a=t.lastName,r=t.date,s=t.id,i=t.closeModal,c=t.removeMeeting;return Object(k.jsx)("div",{className:"list__modal modal",onClick:function(t){return e.handleClick(t)},"aria-hidden":!0,children:Object(k.jsxs)("div",{className:"modal__content",children:[Object(k.jsx)("button",{className:"modal__btn",title:"close window",type:"button",onClick:function(){return i()},children:"\u2715"}),Object(k.jsxs)("p",{className:"modal__paragraph",children:["Remove meeting with"," ",Object(k.jsxs)("span",{className:"modal__highlight",children:[n," ",a]})," ","on ",x(r),"?"]}),Object(k.jsxs)("div",{className:"modal__actions",children:[Object(k.jsx)("button",{className:"modal__confirm",onClick:function(){return c(s)},type:"button",children:"yes"}),Object(k.jsx)("button",{className:"modal__cancel",onClick:function(){return i()},type:"button",children:"no"})]})]})})}}]),n}(r.a.Component)),w=function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;Object(c.a)(this,n);for(var a=arguments.length,r=new Array(a),s=0;s<a;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isModal:!1},e.showModal=function(){e.setState({isModal:!0})},e.closeModal=function(){e.setState({isModal:!1})},e}return Object(o.a)(n,[{key:"render",value:function(){return Object(k.jsxs)("li",{className:"list__item",children:[this.renderItemCard(),this.renderItemPersonInfo(),this.renderConfirmation()]})}},{key:"renderItemCard",value:function(){var e=this.props.data,t=e.date,n=e.time,a=function(e){var t=new Date(e).toLocaleString("en-us",{month:"short"}).toUpperCase(),n=e.split("-").reverse();return n[1]=t,n}(t),r=Object(S.a)(a,3),s=r[0],i=r[1],c=r[2];return Object(k.jsxs)("div",{className:"list__card",children:[Object(k.jsx)("span",{className:"list__window"}),Object(k.jsxs)("div",{className:"list__date",children:[Object(k.jsx)("p",{className:"list__day",children:+s}),Object(k.jsxs)("p",{className:"list__month",children:[i," ",c]})]}),Object(k.jsx)("p",{className:"list__time",children:n})]})}},{key:"renderItemPersonInfo",value:function(){var e=this,t=this.props.data,n=t.name,a=t.lastName,r=t.email;return Object(k.jsxs)("div",{className:"list__wrapper",children:[Object(k.jsxs)("div",{className:"list__person",children:[Object(k.jsx)("p",{className:"list__name",children:n}),Object(k.jsx)("p",{className:"list__surname",children:a}),Object(k.jsx)("a",{className:"list__email",href:"mailto:".concat(r),children:r})]}),Object(k.jsx)("button",{className:"list__btn",title:"remove meeting",onClick:function(){return e.showModal()},children:"remove"})]})}},{key:"renderConfirmation",value:function(){var e=this.props.removeMeeting,t=this.props.data,n=t.name,a=t.lastName,r=t.date,s=t.id;return this.state.isModal?Object(k.jsx)(M,{name:n,lastName:a,date:r,id:s,closeModal:this.closeModal,removeMeeting:e}):null}}]),n}(r.a.Component),I=(n(24),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(o.a)(n,[{key:"render",value:function(){return Object(k.jsxs)("section",{className:"calendar__section calendar__section--list",children:[Object(k.jsx)("header",{className:"calendar__subheader calendar__subheader--list",children:Object(k.jsx)("h2",{className:"calendar__subtitle",children:"meeting list"})}),Object(k.jsx)("div",{className:"calendar__container",children:this.renderSectionContent()})]})}},{key:"renderSectionContent",value:function(){var e=this.props.meetingsList;return p(e)?this.renderInfoMsg():this.renderMeetingsList()}},{key:"renderInfoMsg",value:function(){return Object(k.jsx)("p",{className:"calendar__msg",children:"meeting list empty"})}},{key:"renderMeetingsList",value:function(){return Object(k.jsx)("ol",{className:"calendar__list list",children:this.renderMeetingItemsList()})}},{key:"renderMeetingItemsList",value:function(){var e=this;return this.props.meetingsList.map((function(t){return Object(k.jsx)(w,{data:t,removeMeeting:e.props.removeMeeting},t.id)}))}}]),n}(r.a.Component)),C=[{name:"name",label:"name",type:"text",filter:!0},{name:"lastName",label:"last name",type:"text",filter:!0},{name:"email",label:"e-mail",type:"email",filter:!0},{name:"date",label:"date",type:"date",filter:!1},{name:"time",label:"time",type:"time",filter:!1}],D=(n(25),function(e){Object(u.a)(n,e);var t=Object(l.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this)).state={meetings:[]},e.addMeeting=function(t){e.api.addData(t).then((function(){return e.loadMeetings()})).catch((function(e){return console.error(e)}))},e.removeMeeting=function(t){e.api.removeData(t).then((function(){return e.loadMeetings()})).catch((function(e){return console.error(e)}))},e.api=new d,e._isMounted=!1,e}return Object(o.a)(n,[{key:"render",value:function(){return Object(k.jsxs)("main",{className:"calendar",children:[Object(k.jsxs)("header",{className:"calendar__header",children:[Object(k.jsx)("p",{className:"calendar__pretitle",children:"welcome to"}),Object(k.jsx)("h1",{className:"calendar__title",children:"meeting planner"}),Object(k.jsxs)("p",{className:"calendar__description",children:["never be"," ",Object(k.jsx)("span",{className:"calendar__highlight",children:"late"})]})]}),Object(k.jsxs)("article",{className:"calendar__wrapper",children:[Object(k.jsx)(N,{fields:C,addMeeting:this.addMeeting}),Object(k.jsx)(I,{meetingsList:this.state.meetings,removeMeeting:this.removeMeeting})]})]})}},{key:"componentDidMount",value:function(){this._isMounted=!0,this.loadMeetings()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"loadMeetings",value:function(){var e=this;this.api.loadData().then((function(e){return function(e){return e.sort((function(e,t){return e.date===t.date?e.time<t.time?-1:1:e.date<t.date?-1:1}))}(e)})).then((function(t){return e._isMounted&&e.setState({meetings:t})})).catch((function(e){return console.error(e)}))}}]),n}(r.a.Component));function E(){return Object(k.jsx)(k.Fragment,{children:Object(k.jsx)(D,{})})}var F=E;i.a.render(Object(k.jsx)(E,{}),document.querySelector("#root"));var L=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,27)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,s=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),s(e),i(e)}))};i.a.render(Object(k.jsx)(r.a.StrictMode,{children:Object(k.jsx)(F,{})}),document.getElementById("root")),L()}},[[26,1,2]]]);
//# sourceMappingURL=main.ca55bfb7.chunk.js.map